From 86f75706e75f4f293b3213939943270a5724c5ef Mon Sep 17 00:00:00 2001
From: Curle <curle@gemwire.uk>
Date: Sun, 12 Apr 2020 00:38:16 +0100
Subject: [PATCH] Adjust tests, now comparing ForgeFlower against a
 known-working copy


diff --git a/test/org/jetbrains/java/decompiler/LVTTest.java b/test/org/jetbrains/java/decompiler/LVTTest.java
index b4af1f7..48ae509 100644
--- a/test/org/jetbrains/java/decompiler/LVTTest.java
+++ b/test/org/jetbrains/java/decompiler/LVTTest.java
@@ -59,5 +59,5 @@ public class LVTTest extends SingleClassesTestBase {
 //  @Test public void testMCAbstractResourcePack() { doTest("net/minecraft/client/resources/AbstractResourcePack"); }
 //  @Test public void testMCGuiShareToLan() { doTest("net/minecraft/client/gui/GuiShareToLan"); }
 //  @Test public void testMCContainerPlayer() { doTest("net/minecraft/inventory/ContainerPlayer"); }
-  @Test public void testMCContainerPlayer() { doTest("net/minecraft/command/PlayerSelector"); }
+//  @Test public void testMCContainerPlayer() { doTest("net/minecraft/command/PlayerSelector"); }
 }
diff --git a/test/org/jetbrains/java/decompiler/MinecraftDecompilationTest.java b/test/org/jetbrains/java/decompiler/MinecraftDecompilationTest.java
index 087c810..53bc732 100644
--- a/test/org/jetbrains/java/decompiler/MinecraftDecompilationTest.java
+++ b/test/org/jetbrains/java/decompiler/MinecraftDecompilationTest.java
@@ -36,7 +36,9 @@ import static org.junit.Assert.assertTrue;
 public class MinecraftDecompilationTest {
   private DecompilerTestFixture fixture;
 
-  private static final String MC_JAR = "minecraft_ff_in.jar";
+  private static final String MC_JAR = "minecraft_raw.jar";
+  private static final String DECOMP_JAR = "minecraft_decomp.jar";
+
   @Before
   public void setUp() throws IOException {
     fixture = new DecompilerTestFixture();
@@ -55,8 +57,8 @@ public class MinecraftDecompilationTest {
 
   @After
   public void tearDown() {
-//    fixture.tearDown();
-//    fixture = null;
+    fixture.tearDown();
+    fixture = null;
   }
 
 //  @Test
@@ -77,10 +79,19 @@ public class MinecraftDecompilationTest {
     decompiler.addSpace(new File(fixture.getTestDataDir(), MC_JAR), true);
     decompiler.decompileContext();
 
-    File unpacked = new File(fixture.getTempDir(), "unpacked");
-    unpack(new File(fixture.getTargetDir(), "bulk.jar"), unpacked);
+    // ==============================================================================
+
+    File unpackedLocalDecomp = new File(fixture.getTestDataDir(), "ffoutput");
+
+    unpack(new File(fixture.getTestDataDir(), "bulk.jar"), unpackedLocalDecomp);
+
+    File unpackedForeignDecomp = new File(fixture.getTestDataDir(), "ffinput");
+
+    unpack(new File(fixture.getTestDataDir(), DECOMP_JAR), unpackedForeignDecomp);
+
+    // ==============================================================================
 
-//    compareDirectories(new File(fixture.getTestDataDir(), "bulk"), unpacked);
+    compareDirectories(unpackedLocalDecomp, unpackedForeignDecomp);
   }
 
   private static void unpack(File archive, File targetDir) {
-- 
2.21.0.windows.1

